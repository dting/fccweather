!function(){"use strict";var t=angular.module("weatherApp",[]);t.controller("weatherController",["$scope","LocationService","WeatherService",function(t,o,e){t.location=void 0,t.weather=void 0,o.getCoordinates().then(function(c){o.getGeocodeInfo(c).then(function(o){t.location=o}),e.getWeatherInfo(c).success(function(o){t.weather=o.scopeData})},function(t){console.log(t)}),t.toggleUnits=function(){t.weather&&e.toggleUnits(t.weather.temp)}}]),t.factory("LocationService",["$q","$http",function(t,o){function e(){var o=t.defer();return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){o.resolve(t.coords)},function(t){t.code==t.PERMISSION_DENIED?c().success(function(t){o.resolve(t)}):o.reject(t)}):c().success(function(t){o.resolve(t)}),o.promise}function c(){return o.get("https://freegeoip.net/json/")}function r(o){var e=t.defer(),c=new google.maps.LatLng(o.latitude,o.longitude);return i.geocode({location:c},function(t,o){if(o==google.maps.GeocoderStatus.OK)if(t[1]){var c={};t[1].address_components.forEach(function(t){var o=t.types[0];a[o]&&(c[o]=t[a[o]])}),e.resolve(c)}else e.reject("Expected result not found: "+t);else e.reject("Geocoder failed due to: "+o)}),e.promise}var i=new google.maps.Geocoder,a={locality:"long_name",administrative_area_level_2:"long_name",administrative_area_level_1:"long_name"};return{getCoordinates:e,getGeocodeInfo:r}}]),t.factory("WeatherService",["$http",function(t){function o(t){return a[~~(t/22.5+.5)%16]}function e(t){var o=["US","BS","BZ","KY","PW"];return-1===o.indexOf(t)?"metric":"imperial"}function c(t){"F"===t.units?(t.units="C",t.value=((t.value-32)/1.8).toFixed(2)):(t.units="F",t.value=(1.8*t.value+32).toFixed(2))}function r(r){return t.get(i,{params:{lat:r.latitude,lon:r.longitude,units:"imperial"}}).success(function(t){var r={};r.temp={value:t.main.temp,units:"F"},r.icon=t.weather[0].icon,"imperial"!==e(t.sys.country)&&c(r.temp),r.description=s[r.icon],r.wind={speed:t.wind.speed+" knots",direction:o(t.wind.deg)},t.scopeData=r})}var i="http://api.openweathermap.org/data/2.5/weather",a=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"],s={"01d":{img:"https://farm8.staticflickr.com/7559/16089993777_8f601d96e2_o.jpg",attr:"https://www.flickr.com/photos/124329303@N08/",text:"sky is clear"},"01n":{img:"https://farm6.staticflickr.com/5604/15481101575_577b9380a3_o.jpg",attr:"https://www.flickr.com/photos/124329303@N08/",text:"sky is clear"},"02d":{img:"https://farm9.staticflickr.com/8391/8476078161_59baaa9355_o.jpg",attr:"https://www.flickr.com/photos/sdasmarchives/",text:"few clouds"},"02n":{img:"https://farm6.staticflickr.com/5465/17214759716_193465c7e1_k.jpg",attr:"https://www.flickr.com/photos/ryanhallock/",text:"few clouds"},"03d":{img:"https://farm4.staticflickr.com/3890/18946819309_64478cf81d_h.jpg",attr:"https://www.flickr.com/photos/michaelpardo/",text:"scattered clouds"},"03n":{img:"https://farm9.staticflickr.com/8711/17336854195_36630c69bf_k.jpg",attr:"https://www.flickr.com/photos/jdamasio/",text:"scattered clouds"},"04d":{img:"https://farm9.staticflickr.com/8061/8231162693_a411f15c51_k.jpg",attr:"https://www.flickr.com/photos/au_unistphotostream/",text:"broken clouds"},"04n":{img:"https://farm8.staticflickr.com/7681/16712423663_4a2ea5ce92_k.jpg",attr:"https://www.flickr.com/photos/tigra-co/",text:"broken clouds"},"09d":{img:"https://farm9.staticflickr.com/8868/18430831370_2b7b070858_h.jpg",attr:"https://www.flickr.com/photos/michaelpardo/",text:"shower rain"},"09n":{img:"https://farm8.staticflickr.com/7696/16895976370_6ae0428987_h.jpg",attr:"https://www.flickr.com/photos/michaelpardo/",text:"shower rain"},"10d":{img:"https://farm2.staticflickr.com/1150/873273143_55c5fcac2f_o.jpg",attr:"https://www.flickr.com/photos/henriquev/",text:"rain"},"10n":{img:"https://farm4.staticflickr.com/3884/14436522280_0096cfd4e2_k.jpg",attr:"https://www.flickr.com/photos/minoru_ntt/",text:"rain"},"11d":{img:"https://farm9.staticflickr.com/8899/18808234182_561f5466c6_k.jpg",attr:"https://www.flickr.com/photos/nealherbert/",text:"Thunderstorm"},"11n":{img:"https://farm8.staticflickr.com/7172/13881379074_adc3f3691a_k.jpg",attr:"https://www.flickr.com/photos/matthew_eaton/",text:"Thunderstorm"},"13d":{img:"https://farm4.staticflickr.com/3500/3251874290_6da9504bef_o.jpg",attr:"https://www.flickr.com/photos/boklm/",text:"Snow"},"13n":{img:"https://farm6.staticflickr.com/5125/5257701655_bbb4790581_o.jpg",attr:"https://www.flickr.com/photos/pasukaru76/",text:"Snow"},"50d":{img:"https://farm8.staticflickr.com/7545/15884841046_442d1f2a2f_k.jpg",attr:"https://www.flickr.com/photos/mlinksva/",text:"mist"},"50n":{img:"https://farm5.staticflickr.com/4026/4479273087_30858afd17_o.jpg",attr:"https://www.flickr.com/photos/22723959@N08/",text:"mist"}};return{getWeatherInfo:r,toggleUnits:c}}])}();